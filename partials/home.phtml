<?php
if (!defined('BASEDIR')) die('You cannot call this script directly !');

// ask database for latest algorithms
require_once BASEDIR . "includes/dataModel.php";
$_model = new DataModel();
$algos = $_model->fetchLatestAlgorithms(NUMBER_OF_LATEST_ALGORITHMS);
$_model->close();

require_once BASEDIR . "includes/viewHelper.php";
?>
    <!-- HEADER -->
    <div class="jumbotron">
        <h1>
            <?= PROJECT_NAME ?>
            <small><?= $l10n['subtitle'] ?></small>
        </h1>
        <p><?= $l10n['welcome_msg'] ?></p>

        <p>
            <a class="btn btn-primary btn-lg" role="button"
               href="<?= url(['action' => 'new']) ?>"><?= $l10n['define_new_algo'] ?></a>
        </p>
    </div>

<?php if (sizeof($algos)): ?>
    <div class="page-header">
        <h1><?= $l10n['latest_algos'] ?></h1>
    </div>

    <!-- CONTENT -->
    <table id="latest-algorithms" class="table table-striped table-hover">
    <?php foreach ($algos as $algo):
        $link = url(['action' => 'view', 'aid' => $algo['aid']]);
        ?>
        <tr>
            <td>
                <span class="name">
                    <a href="<?= $link ?>"><?= $algo['name'] ?></a>
                </span>
                <?php if ($algo['age'] <= MAX_MINUTES_FOR_LABEL): ?>
                    <span class="label label-default"><?= $l10n['label_new'] ?></span>
                <?php endif ?>
                <span class="properties">
                    (<?= sprintf($l10n['created_note'], getTimeFrame($algo['age']), $algo['username']) ?>)
                </span>
                <hr class="separator"/>
                <span class="description"><?= skipDescription($algo['description']) ?></span>
                <span class="link">
                    (<a href="<?= $link ?>">&rarr; <?= $l10n['read_more'] ?></a>)
                </span>
            </td>
        </tr>
    <?php endforeach ?>
    </table>
<?php endif ?>