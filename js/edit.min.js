/*
 @license
 This file was created 2014-2015 by https://github.com/wurfmaul
 and licensed under the GNU GENERAL PUBLIC LICENSE Version 3
 https://gnu.org/licenses/gpl-3.0.txt
 */
(function(){$(function(){return $(".close").click(function(){return $(this).parent(".alert").hide("slow")})})}).call(this),function(){var t;t=function(){function t(){}return t.init=function(){return this.sectionNumberToPanels(this.computeSectionNumber())},t.updateUrl=function(t){return $.ajax("api/url.php",{type:"GET",data:{parameters:t},dataType:"text",success:function(t){return function(t){return window.history.pushState("","",t)}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t.performToggle=function(t){var e;return this.toggleSection(t,"slow"),e=this.panelsToSectionNumber(),this.updateUrl({params:window.current.parameters,section:e}),this.storeSectionNumber(e)},t.toggleSection=function(t,e){return t.find("span").toggleClass("glyphicon-chevron-right glyphicon-chevron-down"),$(t.data("target")).toggle(e),$(t).toggleClass("collapsed")},t.panelsToSectionNumber=function(){var t,e;return e=0,t=1,$(".panel-heading").each(function(){return $(this).hasClass("collapsed")||(e+=t),t*=2}),e},t.sectionNumberToPanels=function(t){var e,r,n,i,o;for(i=$(".panel-heading"),n=i.length-1,o=[];t>=0&&n>=0;)e=Math.pow(2,n),t>=e?t-=e:(r=$(i[n]),this.toggleSection(r,0)),o.push(n--);return o},t.computeSectionNumber=function(){var t;return null!=(t=window.current.section)?t:localStorage&&null!=(t=localStorage.getItem("section_"+window.current.action))?t:window.defaults.section},t.storeSectionNumber=function(t){return localStorage.setItem("section_"+window.current.action,t)},t}(),t.init(),$(function(){return $(".panel-heading").click(function(){return t.performToggle($(this))})})}.call(this),function(){var t,e;e=function(t){return t.split(/,\s*/)},t=function(t){return e(t).pop()},window.initTagInput=function(r){var n;return n=[],$(r).autocomplete({minLength:0,source:function(e,r){return 0===n.length?$.getJSON("api/tag.php",function(i,o,a){return n=i.tags,r($.ui.autocomplete.filter(n,t(e.term)))}):r($.ui.autocomplete.filter(n,t(e.term)))},focus:function(){return!1},select:function(t,r){var n;return n=e(this.value),n.pop(),n.push(r.item.value),n.push(""),this.value=n.join(", "),!1}})},window.initFuncInput=function(e){return null!=e.autocomplete("instance")&&e.autocomplete("destroy"),e.autocomplete({delay:0,minLength:1,source:function(e,r){return $.getJSON("api/list.php?query="+e.term,{term:t(e.term)},r)},select:function(t,e){return $(this).val(e.item.name),$(this).closest(".function-node").data("callee-id",e.item.value),!1}}).focusout(function(){return $(this).autocomplete("close")})},window.initVarInput=function(t){var e,r;return r=[],$(".varRow").not("#var-prototype").each(function(){return r.push($(this).data("name"))}),e=["","[*]",".length"],null!=t.autocomplete("instance")&&t.autocomplete("destroy"),t.autocomplete({delay:0,minLength:0,source:function(t,n){var i,o,a;return a=t.term,""===a?this.src=r:$.inArray(a,r)>-1&&(o=[],$.each(e,function(t,e){return o.push({value:a+e,label:a+e,variable:a})}),this.src=o),i=new RegExp($.ui.autocomplete.escapeRegex(t.term),"i"),n($.grep(this.src,function(t){return t=t.label||t.value||t,i.test(t)}))},select:function(t,e){var r,n;return n=null!=(r=e.item.variable)?r:e.item.label,$(this).autocomplete("search",n)}}).click(function(){return $(this).autocomplete("search",$(this).val())}).focusout(function(){return $(this).autocomplete("close")})},window.initValueInput=function(t){var e;return e=t.find(".value"),null!=e.autocomplete("instance")&&e.autocomplete("destroy"),e.autocomplete({delay:0,minLength:0,source:window.initializations}).click(function(){return $(this).autocomplete("search","")}).focusout(function(){return $(this).autocomplete("close")})}}.call(this),function(){var t,e,r,n,i,o,a,u,s,c,l,d,p=function(t,e){function r(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},h={}.hasOwnProperty,f=function(t,e){return function(){return t.apply(e,arguments)}};u=function(){function e(){}return e.prototype.execute=function(t,e){throw new Error("Node must override execute() method!")},e.prototype.executeIndex=function(t,e){if("const"===t.kind&&"int"===t.type)return t.value;if("var"===t.kind)return e.stats.readVar(t.vid),e.memory.get(t.vid).value;if("comp"===t.kind)return this.executeValue(t,e);throw new ExecutionError("unsupported_index",[t.kind])},e.prototype.executeValue=function(t,e){var r,n,i;if(null==(null!=t?t.kind:void 0))throw new ExecutionError("could_not_execute_value",[t]);switch(t.kind){case"const":return t.value;case"index":return this.readVar(t,e);case"prop":if("length"===t.prop)return i=e.memory.get(t.vid),i.array?i.value.split(",").length:1;throw new ExecutionError("unknown_property",[t.prop]);case"var":return this.readVar(t,e);case"comp":switch(r=this.executeValue(t.left,e),n=this.executeValue(t.right,e),e.stats.incArithmeticLogicOps(),t.op){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":if(0===n)throw new ExecutionError("divide_by_zero",[]);return parseInt(r/n);case"%":return r%n;case"&":return r&&n;case"|":return r||n;default:throw new ExecutionError("unknown_arithmetic_op",[this.operator])}break;default:throw new ExecutionError("unknown_kind",[t.kind])}},e.prototype.readVar=function(t,e){var r,n;switch(t.kind){case"index":return r=this.executeIndex(t.index,e),e.stats.readArrayVar(t.vid,r),e.memory.arrayGet(t.vid,r);case"var":return n=t.vid,e.stats.readVar(n),e.memory.get(n).value;default:throw new ExecutionError("unknown_kind",[t.kind])}},e.prototype.writeVar=function(t,e,r){var n;switch(t.kind){case"index":return n=this.executeIndex(t.index,r),r.memory.arraySet(t.vid,n,e),r.stats.writeArrayVar(t.vid,n,e);case"var":return r.memory.set(t.vid,e),r.stats.writeVar(t.vid,e);case"const":throw new ExecutionError("assign_to_const",[t.value]);case"prop":throw new ExecutionError("assign_to_prop",[]);default:throw new ExecutionError("unknown_kind",[t.kind])}},e.prototype.mark=function(t,e){return e===this.nid?(t.setCursor(this.nid,0),this.nid):-1},e.prototype.toJSON=function(){throw new Error("Node must override toJSON() method!")},e.parse=function(e,u,p){var h;switch(h=e.data("node-type")){case"assign":return t.parse(e,u,p);case"comment":return r.parse(e,u,p);case"compare":return n.parse(e,u,p);case"function":return i.parse(e,u,p);case"if":return o.parse(e,u,p);case"inc":return a.parse(e,u,p);case"return":return s.parse(e,u,p);case"swap":return c.parse(e,u,p);case"value":return l.parse(e,u,p);case"while":return d.parse(e,u,p);default:throw new Error("Parse error: unknown type: '"+h+"'")}},e.parseAndCheckValue=function(t,e,r){var n;return e=this.findSubNode(e,t),n=this.parseValue(e.val(),r),null==n?e.addClass("error"):e.removeClass("error"),n},e.parseAndCheckVar=function(t,e,r){var n;return e=this.findSubNode(e,t),n=this.parseValue(e.val(),r),null==n||"var"!==n.kind&&"index"!==n.kind?(e.addClass("error"),null):(e.removeClass("error"),n)},e.parseValue=function(t,e){var r,n,i,o,a,u,s,c,l,d;if(t=$.trim(t),n=DataType.parse(t))return{kind:"const",type:n.type,value:n.value};if(u=t.indexOf("["),r=t.lastIndexOf("]"),u>-1&&r>u)return d=e.find(t.substr(0,u)),i=this.parseValue(t.substr(u+1,r-u-1),e),d>-1&&null!=i?(e.count(d),{kind:"index",vid:d,index:i}):null;if(s=t.indexOf("."),s>-1&&"length"===t.substr(s+1))return d=e.find(t.substr(0,s)),d>-1?(e.count(d),{kind:"prop",type:"int",vid:d,prop:"length"}):null;if(/^[A-Za-z]+$/.test(t))return d=e.find(t),d>-1?(e.count(d),{kind:"var",vid:d}):null;if(t=t.replace(/\s*/g,""),-1===t.indexOf("(")&&(l=t.split(/(-|\+|\*|\/|%|&|\|)/i),3===l.length))return o=this.parseValue(l[0],e),c=this.parseValue(l[2],e),null!=o&&null!=c&&"+-*/%&|".indexOf(l[1])>=0?{kind:"comp",left:o,right:c,op:l[1]}:null;if(null!=(t=this.parsePars(t)))switch(Object.keys(t).length){case 1:return this.parseValue(t[0],e);case 3:if(o=this.parseValue(t[0],e),c=this.parseValue(t[2],e),a=t[1],null!=o&&null!=c&&"+-*/%&|".indexOf(t[1])>=0)return{kind:"comp",left:o,right:c,op:a}}return null},e.parsePars=function(t){var e,r,n,i,o,a,u,s;for(o=0,u={},n=0,s=t.split(/(-|\+|\*|\/|%|&|\||\(|\))/g),r=i=0,a=s.length;a>=0?a>i:i>a;r=a>=0?++i:--i)if(e=s[r],""!==e)if(0===o)"("===e?o++:")"===e?o--:u[n++]=e;else{if("("===e)o++;else if(")"===e&&0===--o){n++;continue}null!=u[n]?u[n]+=e:u[n]=e}return 0!==o?(console.log("Unbalanced"),null):u},e.findSubNode=function(t,e){return t.find(e+":first")},e.validate=function(t,e){var r;return r=t.find(".invalid-flag:first"),e?(t.removeClass("invalid"),r.hide()):(t.addClass("invalid"),r.show())},e}(),t=function(t){function r(t,e,r){this.nid=t,this.from=e,this.to=r}return p(r,t),r.prototype.execute=function(t,e){return e=t.tree.get(this.from).execute(t,0),null==e.scope&&this.writeVar(this.to,e.value,t),e},r.prototype.toJSON=function(){return{nid:this.nid,node:"assign",from:this.from,to:this.to}},r.parse=function(t,n,i){var o,a,u;return o=e.parse(r.findSubNode(t,".assign-from"),n,i),n.push(o),u=r.parseAndCheckVar(".assign-to",t,i),r.validate(t,null!=u&&o.size()),a=n.length,new r(a,o.nid,u)},r}(u),e=function(t){function e(t,e){this.nid=t,this.nodes=e,this.curNode=0}return p(e,t),e.prototype.execute=function(t,e){var r,n,i,o,a,u,s;for(r=null,u=this.nodes,n=i=0,o=u.length;o>i;n=++i)if(a=u[n],a>=e){r=t.tree.get(a).execute(t,e);break}return s=null!=(null!=r?r.value:void 0)?r.value:!1,null!=(null!=r?r.scope:void 0)?r:null!=(null!=r?r.next:void 0)?{next:r.next,value:s}:-1===r?{next:-1,value:s}:this.nodes.length>n+1?{next:this.nodes[n+1],value:s}:{value:s}},e.prototype.executeAll=function(t,e,r){var n,i,o,a,u,s,c,l;for(l="all"===r,s=-1,c=this.nodes,i=o=0,a=c.length;a>o;i=++o){if(u=c[i],u>e){s=u;break}if(n=t.tree.get(u).execute(t,u).value,"all"===r&&(l=l&&n),"any"===r&&(l=l||n),window.defaults.shortCircuit&&!l)break}return{value:l,next:s}},e.prototype.mark=function(t,e){var r,n,i,o,a,u,s,c,l;if(e===this.nid){for(c=this.nodes,r=n=0,o=c.length;o>n;r=++n)if(s=c[r],u=t.tree.get(s).mark(t,s),u>-1)return u;return-1}for(l=this.nodes,r=i=0,a=l.length;a>i;r=++i)if(s=l[r],s>=e){if(u=t.tree.get(s).mark(t,e),u>-1)return u;e=s+1}return-1},e.prototype.size=function(){return this.nodes.length},e.prototype.toJSON=function(){return{nid:this.nid,node:"block",nodes:this.nodes}},e.parse=function(t,r,n){var i,o;return o=[],t.children("li.node").each(function(t,e){var i;return i=u.parse($(e),r,n),r.push(i),o[t]=i.nid}),i=r.length,new e(i,o)},e}(u),r=function(t){function e(t,e){this.nid=t,this.comment=e}return p(e,t),e.prototype.execute=function(t,e){return{value:!1}},e.prototype.mark=function(t,e){return-1},e.prototype.toJSON=function(){return{nid:this.nid,node:"comment",comment:this.comment}},e.parse=function(t,r,n){var i,o;return i=e.findSubNode(t,".comment-text").val(),o=r.length,new e(o,i)},e}(u),n=function(t){function e(t,e,r,n){this.nid=t,this.left=e,this.right=r,this.operator=n}return p(e,t),e.prototype.execute=function(t,e){var r,n;switch(r=this.executeValue(this.left,t),n=this.executeValue(this.right,t),t.stats.incCompareOps(),this.operator){case"le":return{value:n>=r};case"lt":return{value:n>r};case"eq":return{value:r===n};case"gt":return{value:r>n};case"ge":return{value:r>=n};case"ne":return{value:r!==n};default:throw new Error("CompareNode: unknown operator: '"+this.operator+"'!")}},e.prototype.toJSON=function(){return{nid:this.nid,node:"compare",left:this.left,right:this.right,operator:this.operator}},e.parse=function(t,r,n){var i,o,a,u;return i=e.parseAndCheckValue(".compare-left",t,n),u=e.parseAndCheckValue(".compare-right",t,n),e.validate(t,null!=i&&null!=u),a=e.findSubNode(t,".compare-operation").val(),o=r.length,new e(o,i,u,a)},e}(u),i=function(t){function r(t,e,r,n){this.nid=t,this.callee=e,this.paramsLine=r,this.params=n}return p(r,t),r.prototype.execute=function(t,e){var r,n,i;return n=t.scope,r=$("#scope-"+n+" .node_"+this.nid),null!=r.data("return-value")?(i=r.data("return-value"),r.removeData("return-value"),{value:i}):this.callFunction(t,r)},r.prototype.callFunction=function(t,e){var r,n,i;return n=t.scope+1,r=$("<a/>").data("target","#scope-"+n).addClass("scope-"+n),r.attr("aria-controls","scope-"+n).attr("role","tab").attr("data-toggle","tab"),r.append($("<i/>").addClass("fa fa-spinner fa-pulse")),$("#scopes-head").append($("<li/>").attr("role","presentation").append(r)),$("#scopes-body").append($("<div/>").attr("role","tabpanel").addClass("tab-pane").attr("id","scope-"+n)),$.ajax("api/scope.php",{type:"POST",data:{aid:this.callee,scope:n,lang:window.current.lang},dataType:"json",async:!1}).done(function(t){return $("#scope-"+n).append(t.algorithm),r.text(t.name)}).fail(function(){return $("#scope-"+n).remove(),r.parent().remove(),t.handleError(new ExecutionError("function_load",[name])),!1}),i=this.paramsLine,{scope:n,node:this.nid,params:i}},r.prototype.toJSON=function(){return{nid:this.nid,node:"function",callee:this.callee,paramsLine:this.paramsLine,params:this.params}},r.parse=function(t,n,i){var o,a,u,s,c,l,d,p,h,f;if(o=t.data("callee-id"),d=[],h=r.findSubNode(t,".act-pars-line").val(),p=!1,""!==h)for(f=h.split(";"),a=0,u=f.length;u>a;a++)c=f[a],c=r.parseValue(c,t,i),null==c?p=!0:d.push(c);return l=e.parse(r.findSubNode(t,".act-pars"),n,i),n.push(l),r.validate(t,o>0&&!p),s=n.length,new r(s,o,d,l.nid)},r}(u),o=function(t){function r(t,e,r,n,i){this.nid=t,this.condition=e,this.ifBody=r,this.elseBody=n,this.op=i}return p(r,t),r.prototype.execute=function(t,e){var r,n,i,o;if(e<=this.condition){if(r=t.tree.get(this.condition),i=r.size(),1===i)n=r.execute(t,e);else{if(!(i>1))throw new ExecutionError("no_condition",[]);n=r.executeAll(t,e,this.op)}return o=n.value+0!==0,n.next>-1?{next:n.next,value:o}:o?{next:this.ifBody,value:o}:{next:this.elseBody,value:o}}return e<=this.ifBody?t.tree.get(this.ifBody).execute(t,e):t.tree.get(this.elseBody).execute(t,e)},r.prototype.mark=function(t,e){return e===this.nid?t.tree.get(this.condition).mark(t,this.condition):e<=this.condition?t.tree.get(this.condition).mark(t,e):e<=this.ifBody?t.tree.get(this.ifBody).mark(t,e):t.tree.get(this.elseBody).mark(t,e)},r.prototype.toJSON=function(){return{nid:this.nid,node:"if",condition:this.condition,ifBody:this.ifBody,elseBody:this.elseBody,op:this.op}},r.parse=function(t,n,i){var o,a,u,s,c,l;return o=e.parse(r.findSubNode(t,".if-condition"),n,i),n.push(o),u=e.parse(r.findSubNode(t,".if-body"),n,i),n.push(u),a=e.parse(r.findSubNode(t,".if-else"),n,i),n.push(a),l=o.size(),r.validate(t,l>0),c=r.findSubNode(t,".if-operator"),l>1?c.show():c.hide(),s=n.length,new r(s,o.nid,u.nid,a.nid,c.val())},r}(u),a=function(t){function e(t,e,r){this.nid=t,this.variable=e,this.operator=r}return p(e,t),e.prototype.execute=function(t,e){var r,n,i,o;return o=this.variable.vid,i=this.executeValue(this.variable,t),n="inc"===this.operator?i+1:i-1,"index"===this.variable.kind?(r=this.executeValue(this.variable.index,t),t.memory.arraySet(o,r,n),t.stats.writeArrayVar(o,r,n)):(t.memory.set(o,n),t.stats.writeVar(o,n)),{value:i}},e.prototype.toJSON=function(){return{nid:this.nid,node:"inc",var:this.variable,operator:this.operator}},e.parse=function(t,r,n){var i,o,a;return a=e.parseAndCheckVar(".inc-var",t,n),e.validate(t,null!=a),o=e.findSubNode(t,".inc-operation").val(),i=r.length,new e(i,a,o)},e}(u),s=function(t){function e(t,e){this.nid=t,this.value=e}return p(e,t),e.prototype.execute=function(t,e){var r;return r=this.executeValue(this.value,t),$("#scope-"+t.scope+" .return-value").val(r).focus(),-1},e.prototype.toJSON=function(){return{nid:this.nid,node:"return",value:this.value}},e.parse=function(t,r,n){var i,o;return o=e.parseAndCheckValue(".return-value",t,n),e.validate(t,null!=o),i=r.length,new e(i,o)},e}(u),c=function(t){function e(t,e,r){this.nid=t,this.left=e,this.right=r}return p(e,t),e.prototype.execute=function(t,e){var r,n;return r=this.executeValue(this.left,t),n=this.executeValue(this.right,t),this.writeVar(this.left,n,t),this.writeVar(this.right,r,t),{value:r!==n}},e.prototype.toJSON=function(){return{nid:this.nid,node:"swap",left:this.left,right:this.right}},e.parse=function(t,r,n){var i,o,a;return i=e.parseAndCheckValue(".swap-left",t,n),a=e.parseAndCheckValue(".swap-right",t,n),e.validate(t,null!=i&&null!=a),o=r.length,new e(o,i,a)},e}(u),l=function(t){function e(t,e){this.nid=t,this.value=e}return p(e,t),e.prototype.execute=function(t,e){return{value:this.executeValue(this.value,t)}},e.prototype.toJSON=function(){return{nid:this.nid,node:"value",value:this.value}},e.parse=function(t,r,n){var i,o;return o=e.parseAndCheckValue(".value-var",t,n),e.validate(t,null!=o),i=r.length,new e(i,o)},e}(u),d=function(t){function r(t,e,r,n){this.nid=t,this.condition=e,this.body=r,this.op=n}return p(r,t),r.prototype.execute=function(t,e){var r,n,i,o;if(e<=this.condition){if(n=t.tree.get(this.condition),o=n.size(),1===o)i=n.execute(t,e);else{if(!(o>1))throw new ExecutionError("no_condition",[]);i=n.executeAll(t,e,this.op)}return i.next>-1?{next:i.next}:i.value?{next:this.body}:{}}return e<=this.body?(r=t.tree.get(this.body).execute(t,e),null!=r.next?{next:r.next}:{next:this.condition}):void 0},r.prototype.mark=function(t,e){var r,n;return n=t.tree.get(this.condition),e===this.nid?n.mark(t,this.condition):e<=this.condition?n.mark(t,e):(r=t.tree.get(this.body),r.size()?r.mark(t,e):n.mark(t,this.condition))},r.prototype.toJSON=function(){return{nid:this.nid,node:"while",condition:this.condition,body:this.body,op:this.op}},r.parse=function(t,n,i){var o,a,u,s,c;return a=e.parse(r.findSubNode(t,".while-condition"),n,i),n.push(a),o=e.parse(r.findSubNode(t,".while-body"),n,i),n.push(o),c=a.size(),r.validate(t,c>0),s=r.findSubNode(t,".while-operator"),c>1?s.show():s.hide(),u=n.length,new r(u,a.nid,o.nid,s.val())},r}(u),window.Tree=function(){function t(t){this.scope=t,this.memory=new Memory($("#scope-"+this.scope+" .variables>tbody")),this.reset()}return t.prototype.execute=function(t,e){return this.get(this.root).execute(t,e)},t.prototype.mark=function(t,e){return this.get(this.root).mark(t,e)},t.prototype.get=function(t){return this.nodes[t]},t.prototype.reset=function(){var t;return this.memory.reset(),this.nodes=[],t=e.parse($("#scope-"+this.scope+" .node_root"),this.nodes,this.memory),this.root=this.nodes.length,this.nodes.push(t)},t.prototype.toJSON=function(){var t,e,r,n,i,o;for(r=[],o=this.nodes,t=e=0,n=o.length;n>e;t=++e)i=o[t],r[t]=i.toJSON();return r},t.toJSON=function(){return new this(0).toJSON()},t}(),window.Memory=function(){function t(t){this.table=t,this.reset=f(this.reset,this),this.arraySet=f(this.arraySet,this),this.arrayGet=f(this.arrayGet,this),this.arrayCheck=f(this.arrayCheck,this),this.set=f(this.set,this),this.get=f(this.get,this),this.find=f(this.find,this),this.count=f(this.count,this),this.memory=new Object,this.original=new Object,this.table.children().not("#var-prototype").each(function(t){return function(e,r){var n,i,o,a;return a=$(r).data("vid"),i=$(r).data("name"),o=$(r).data("value"),n="array"===$(r).data("type").substr(0,5),t.memory[a]={vid:a,name:i,value:o,array:n,count:0},t.original[a]={vid:a,name:i,value:o,array:n,count:0}}}(this))}return t.prototype.count=function(t){var e;return e=this.memory[t],++e.count},t.prototype.find=function(t){var e;return e=-1,$.each(this.memory,function(r,n){return n.name===t?e=n.vid:void 0}),e},t.prototype.get=function(t){return this.memory[t]},t.prototype.set=function(t,e){var r;try{e.split(","),this.memory[t].array=!0}catch(e){r=e,this.memory[t].array=!1}return this.memory[t].value=e},t.prototype.arrayCheck=function(t,e){var r,n;if(n=this.get(t),!n.array)throw new ExecutionError("no_array_for_index",[n.name]);if(r=n.value.split(","),0>e||r.length<=e)throw new ExecutionError("index_out_of_bounds",[n.name,e,r.length]);return r},t.prototype.arrayGet=function(t,e){var r,n;return r=this.arrayCheck(t,e),n=r[e],parseInt(n)+""===n?parseInt(n):n},t.prototype.arraySet=function(t,e,r){var n;return n=this.arrayCheck(t,e),n[e]=r,this.set(t,n.join(","))},t.prototype.reset=function(){return $.each(this.original,function(t){return function(e,r){return t.memory[e].value=r.value,t.memory[e].count=0}}(this))},t}(),window.DataType=function(){function t(){}return t.parse=function(t){var e,r;return r=parseInt(t),r+""===t?{type:"int",value:r}:(e=t.toLowerCase(),"true"===e||"false"===e?{type:"bool",value:"true"===e}:!1)},t}(),window.ExecutionError=function(t){function e(t,e){this.message=t,this.parts=e}return p(e,t),e}(Error)}.call(this),function(){var t,e,r,n,i,o,a,u;e=$(".node_root"),n=$("#insertVarsHere"),t=function(){function t(){}return t.editInfo=function(){var t,e,r;return r=$("#in-name").val(),t=$("#in-desc").val(),e=$("#in-long").val(),$.ajax("api/algorithm.php?area=info",{type:"POST",data:{name:r,desc:t,long:e,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return null==e.error?(t._printSuccess(e.success),$(".has-error").removeClass("has-error")):(t._printError(e.error),null!=e.name?$("#in-name").val(e.name).closest(".form-group").addClass("has-error"):void 0)}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t.editTags=function(){var t;return t=$("#in-tags").val(),$.ajax("api/tag.php",{type:"POST",data:{tags:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return $("#in-tags").val(e.tags),null==e.error?(t._printSuccess(e.success),$(".has-error").removeClass("has-error")):(t._printError(e.error),null!=e.tags?$("#in-tags").closest(".form-group").addClass("has-error"):void 0)}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t.editVariable=function(t){var e,r,n,i,o;return o=$("#var-"+t),e=o.find(".name").val(),n=o.find(".type").val(),i=o.find(".value").val(),r=o.find(".size").val(),$.ajax("api/algorithm.php?area=var&action=edit",{type:"POST",data:{vid:t,name:e,type:n,value:i,size:r,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(e){return function(r){var n,i,a,u,s,c;for(a=null!=(u=r.error)?u:"",o=$("#var-"+t),s=["name","type","value","size"],n=0,i=s.length;i>n;n++)c=s[n],null!=r["error-"+c]?(a+=r["error-"+c],o.find("."+c+"-group").addClass("has-error")):(o.find("."+c+"-group").removeClass("has-error"),o.data(c,r[c]));return""!==a?e._printError(a):(e._printSuccess(r.success),o.find(".edit").hide(),o.find(".view .cell").text(r.viewLabel),null!=r.viewMode&&o.find(".view .details").text("("+r.viewMode+")"),o.find(".view").show(),initVarInput($(".insertStepsHere").find(".combobox")))}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t.removeVariable=function(t){return $.ajax("api/algorithm.php?area=var&action=remove",{type:"POST",data:{vid:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(e){return function(r){return null!=r.error?e._printError(r.error):(e._printSuccess(r.success),$("#var-"+t).hide("slow",function(){return $(this).remove()}))}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t.editScript=function(t){return $.ajax("api/algorithm.php?area=script",{type:"POST",data:{tree:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return null!=e.error?t._printError(e.error):t._printSuccess(e.success)}}(this),error:function(t){return function(e,r,n){return t._printError("Storage Error: "+n)}}(this)})},t.parseMarkdown=function(t,e){return $.ajax("api/markdown.php",{type:"POST",data:{source:$(t).val()},dataType:"json",success:function(t){return function(t){return""===t.html?$(e).parent().hide("slow"):$(e).html(t.html).parent().show("slow")}}(this),error:function(t){return function(e,r,n){return t._printError("Request Error: "+n)}}(this)})},t._printError=function(t){return $("#alertText").html(t),$("#alert").show("slow")},t._printSuccess=function(t){return $("#alert").hide("slow"),$("#saveSuccess:hidden").text(t).show("slow",function(){return $(this).fadeOut(3e3)})},t}(),i=function(){function e(){var t;t=$(".varRow").not("#var-prototype").last().data("vid"),this.maxVarId=null!=t?t+1:0,this.updateVarCount()}return e.prototype.addRow=function(){var t;return t=$("#var-prototype").clone(!0).attr("id","var-"+this.maxVarId).data("vid",this.maxVarId).appendTo(n),t.find(".btn-var-count").data("target","var-"+this.maxVarId),t.find(".edit").show(),t.find(".view").hide(),t.show("slow"),initValueInput(t.find(".value-group")),this.maxVarId++},e.prototype.updateVarCount=function(){return $(".varRow").not("#var-prototype").each(function(){var t,e,r;return r=$(this).data("vid"),e=new Tree(0),t=e.memory.get(r).count,$(this).find(".counter").text(t),0!==t?$(this).find(".btn-var-remove").attr("disabled","disabled"):$(this).find(".btn-var-remove").removeAttr("disabled")})},e.prototype.performCancel=function(t){var e,r;return $("#alert").hide("slow"),r=$("#var-"+t),e=r.data("name"),null!=e&&""!==e?(r.find(".name").val(e),r.find(".init").val(r.data("init")),r.find(".value").val(r.data("value")),r.find(".size").val(r.data("size")),r.find(".edit").hide(),r.find(".view").show()):r.hide("slow",function(){return $(this).remove()})},e.prototype.performCheck=function(e){return t.editVariable(e)},e.prototype.performEdit=function(t){var e;return e=$("#var-"+t),initValueInput(e.find(".value-group")),e.find(".edit").show().find(".name").attr("disabled","disabled"),e.find(".view").hide()},e.prototype.performRemove=function(e){return t.removeVariable(e)},e}(),r=function(){function r(t){this.varForm=t}return r.prototype.addNode=function(t){var r;return r=$(".prototypes ."+t).clone().appendTo(e),this.varForm.updateVarCount(),this.updateSortable(),this.updateActionHandlers(r),r},r.prototype.removeNode=function(t){return t.hide("slow",function(e){return function(){return t.remove(),e.varForm.updateVarCount(),e.saveChanges()}}(this))},r.prototype.saveChanges=function(){var r;return r=Tree.toJSON(),e.find(".invalid").length?!1:(this.varForm.updateVarCount(),t.editScript(r),!0)},r.prototype.updateActionHandlers=function(t){return initVarInput(t.find(".combobox")),initFuncInput(t.find(".combobox-functions")),t.find("input, textarea").off("blur").blur(function(t){return function(){return t.saveChanges()}}(this)),t.find("select").off("change").change(function(t){return function(){return t.saveChanges()}}(this)),t.find(".node-remove").off("click").click(function(t){return function(e){return t.removeNode($(e.currentTarget).parents(".node:first"))}}(this))},r.prototype.updateSortable=function(){var t,r;return r=function(t){return function(){return t.saveChanges(),!0}}(this),t={connectWith:".sortable",placeholder:"sortable-highlight",update:r},e.find(".sortable").each(function(){return null!=$(this).sortable("instance")?$(this).sortable("destroy"):void 0}),e.sortable(t),e.find(".sortable").sortable(t)},r}(),u=function(t){var e,r;return e=$(t).find("option:selected"),r=e.closest(".varRow").find(".size-group"),".size"===e.data("target")?r.show("slow"):r.hide("slow")},a=function(){var t;return t=0,function(e,r){return clearTimeout(t),t=setTimeout(e,r)}}(),o=function(){return t.parseMarkdown($("#in-long"),$("#description-preview"))},$(function(){var n,s;return initTagInput($("#in-tags")),$("#in-name, #in-desc, #in-long").blur(function(){return t.editInfo()}),$("#in-tags").blur(function(){return t.editTags()}),$("#in-long").keyup(function(){return a(function(){return o()},500)}),$("#refresh-preview").click(function(){return o()}),s=new i,$("#btnAddVar").click(function(){return s.addRow()}),$(".btn-var-cancel").click(function(){return s.performCancel($(this).parents(".varRow").data("vid"))}),$(".btn-var-check").click(function(){return s.performCheck($(this).parents(".varRow").data("vid"))}),$(".btn-var-edit").click(function(){return s.performEdit($(this).parents(".varRow").data("vid"))}),$(".btn-var-remove").click(function(){return s.performRemove($(this).parents(".varRow").data("vid"))}),$(".type").change(function(){return u($(this))}),n=new r(s),n.updateActionHandlers(e),n.updateSortable(),$("#node-btn-group a").click(function(){return n.addNode($(this).data("node"))}),$(".toggle-comment").click(function(){return $(this).parent().find(".comment-container").toggle("slow"),$(this).toggleClass("fa-plus-square fa-minus-square")}),Tree.toJSON(0)})}.call(this);