/*
 @license
 This file was created 2014-2015 by https://github.com/wurfmaul
 and licensed under the GNU GENERAL PUBLIC LICENSE Version 3
 https://gnu.org/licenses/gpl-3.0.txt
 */
(function(){$(function(){return $(".close").click(function(){return $(this).parent(".alert").hide("slow")})})}).call(this),function(){var t;t=function(){function t(){}return t.init=function(){return this.sectionNumberToPanels(this.computeSectionNumber())},t.updateUrl=function(t){return $.ajax("api/url.php",{type:"GET",data:{parameters:t},dataType:"text",success:function(t){return function(t){return window.history.pushState("","",t)}}(this)})},t.performToggle=function(t){var e;return this.toggleSection(t,"slow"),e=this.panelsToSectionNumber(t),this.sectionNumberToPanels(e),this.updateUrl({params:window.current.parameters,section:e}),this.storeSectionNumber(e)},t.hideSection=function(t,e){return t.find(".glyphicon").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-right"),t.siblings(".panel-collapse").hide(e),$(t).addClass("collapsed")},t.showSection=function(t,e){return t.find(".glyphicon").removeClass("glyphicon-chevron-right").addClass("glyphicon-chevron-down"),t.siblings(".panel-collapse").show(e),$(t).removeClass("collapsed")},t.toggleSection=function(t,e){return t.find(".glyphicon").toggleClass("glyphicon-chevron-right glyphicon-chevron-down"),t.siblings(".panel-collapse").toggle(e),$(t).toggleClass("collapsed")},t.panelsToSectionNumber=function(t){var e,n;return n=0,e=1,t.closest(".scope").find(".panel-heading").each(function(){return $(this).hasClass("collapsed")||(n+=e),e*=2}),n},t.sectionNumberToPanels=function(e){return $(".scope").each(function(){var n,r,o,i,a,u;for(i=$(this).find(".panel-heading"),o=i.length-1,u=e,t.showSection(i,0),a=[];u>=0&&o>=0;)n=Math.pow(2,o),u>=n?u-=n:(r=$(i[o]),t.hideSection(r,0)),a.push(o--);return a})},t.computeSectionNumber=function(){var t;return null!=(t=window.current.section)?t:localStorage&&null!=(t=localStorage.getItem("section_"+window.current.action))?t:window.defaults.section},t.storeSectionNumber=function(t){return localStorage.setItem("section_"+window.current.action,t)},t}(),t.init(),$(function(){return $(".panel-heading").click(function(){return t.performToggle($(this))})})}.call(this),function(){var t,e;e=function(t){return t.split(/,\s*/)},t=function(t){return e(t).pop()},window.initTagInput=function(n){var r;return r=[],$(n).autocomplete({minLength:0,source:function(e,n){return 0===r.length?$.getJSON("api/tag.php",function(o,i,a){return r=o.tags,n($.ui.autocomplete.filter(r,t(e.term)))}):n($.ui.autocomplete.filter(r,t(e.term)))},focus:function(){return!1},select:function(t,n){var r;return r=e(this.value),r.pop(),r.push(n.item.value),r.push(""),this.value=r.join(", "),!1}})},window.initFuncInput=function(e){return null!=e.autocomplete("instance")&&e.autocomplete("destroy"),e.autocomplete({delay:0,minLength:1,source:function(e,n){return $.getJSON("api/list.php?query="+e.term,{term:t(e.term)},n)},select:function(t,e){return $(this).val(e.item.name),$(this).closest(".function-node").data("callee-id",e.item.value),!1}}).focusout(function(){return $(this).autocomplete("close")})},window.initVarInput=function(t){var e,n;return n=[],$(".varRow").not("#var-prototype").each(function(){return n.push($(this).data("name"))}),e=["","[*]",".length"],null!=t.autocomplete("instance")&&t.autocomplete("destroy"),t.autocomplete({delay:0,minLength:0,source:function(t,r){var o,i,a;return a=t.term,""===a?this.src=n:$.inArray(a,n)>-1&&(i=[],$.each(e,function(t,e){return i.push({value:a+e,label:a+e,variable:a})}),this.src=i),o=new RegExp($.ui.autocomplete.escapeRegex(t.term),"i"),r($.grep(this.src,function(t){return t=t.label||t.value||t,o.test(t)}))},select:function(t,e){var n,r;return r=null!=(n=e.item.variable)?n:e.item.label,$(this).autocomplete("search",r)}}).click(function(){return $(this).autocomplete("search",$(this).val())}).focusout(function(){return $(this).autocomplete("close")})},window.initValueInput=function(t){var e,n,r;return e=t.find(".init"),n=t.find(".value"),r=[],e.find(".combo-box").each(function(){return r.push({value:$(this).val(),label:$(this).text(),target:$(this).data("target")})}),n.blur(function(){var o,i,a,u,s,c;return u=$(this).val(),o=!1,a=null,$.each(r,function(t,n){return u===n.label?(e.val(n.value),o=!0,a=n.target):void 0}),o||e.val("C"),s=t.find(".type-group"),i=t.find(".size-group"),null!=a&&".type"===a?(c=s.show("slow").find(".type").focus(),"["===c.val().charAt(0)?i.show("slow"):i.hide("slow")):(s.hide("slow"),i.hide("slow"),n.focusout())}),null!=n.autocomplete("instance")&&n.autocomplete("destroy"),n.autocomplete({delay:0,minLength:0,source:r,select:function(t,e){return t.preventDefault(),n.val(e.item.label),n.blur()}}).click(function(){return $(this).autocomplete("search","")}).focusout(function(){return $(this).autocomplete("close")})}}.call(this),function(){var t,e,n,r,o,i=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;window.Value=function(){function i(){}return i.prototype.execute=function(t){throw new ExecutionError("could_not_execute_value",[value])},i.read=function(t,e){var n,r,o;switch(t.kind){case"index":n=t.index.execute(e),e.stats.readArrayVar(t.vid,n),r=e.memory.arrayGet(t.vid,n);break;case"var":o=t.vid,e.stats.readVar(o),r=e.memory.get(o).value;break;default:throw new ExecutionError("unknown_kind",[t.kind])}if("P"===r)throw new ExecutionError("param_not_set",[]);return r},i.write=function(t,e,n){var r;switch(t.kind){case"index":return r=this.executeIndex(t.index,n),n.memory.arraySet(t.vid,r,e),n.stats.writeArrayVar(t.vid,r,e);case"var":return n.memory.set(t.vid,e),n.stats.writeVar(t.vid,e);case"const":throw new ExecutionError("assign_to_const",[t.value]);case"prop":throw new ExecutionError("assign_to_prop",[]);default:throw new ExecutionError("unknown_kind",[t.kind])}},i.parse=function(i,a){var u,s,c,l,d,p,h,f,v,m;if(i=$.trim(i),s=DataType.parse(i))return new e(s.type,s.value);if(p=i.indexOf("["),u=i.lastIndexOf("]"),p>-1&&u>p)return m=a.find(i.substr(0,p)),c=this.parse(i.substr(p+1,u-p-1),a),m>-1&&null!=c?(a.count(m),new n(m,c)):null;if(h=i.indexOf("."),h>-1)return m=a.find(i.substr(0,h)),m>-1?(a.count(m),new r(m,i.substr(h+1))):null;if(/^[A-Za-z]+$/.test(i))return m=a.find(i),m>-1?(a.count(m),new o(m)):null;if(i=i.replace(/\s*/g,""),-1===i.indexOf("(")&&(v=i.split(/(-|\+|\*|\/|%|&|\|)/i),3===v.length))return l=this.parse(v[0],a),f=this.parse(v[2],a),null!=l&&null!=f&&"+-*/%&|".indexOf(v[1])>=0?new t(l,f,v[1]):null;if(null!=(i=this.parsePars(i)))switch(Object.keys(i).length){case 1:return this.parse(i[0],a);case 3:if(l=this.parse(i[0],a),f=this.parse(i[2],a),d=i[1],null!=l&&null!=f&&"+-*/%&|".indexOf(i[1])>=0)return new t(l,f,d)}return null},i.parsePars=function(t){var e,n,r,o,i,a,u,s;for(i=0,u={},r=0,s=t.split(/(-|\+|\*|\/|%|&|\||\(|\))/g),n=o=0,a=s.length;a>=0?a>o:o>a;n=a>=0?++o:--o)if(e=s[n],""!==e)if(0===i)"("===e?i++:")"===e?i--:u[r++]=e;else{if("("===e)i++;else if(")"===e&&0===--i){r++;continue}null!=u[r]?u[r]+=e:u[r]=e}return 0!==i?(console.warn("Unbalanced expression!"),null):u},i}(),t=function(t){function e(t,e,n){this.left=t,this.right=e,this.op=n,this.kind="comp"}return i(e,t),e.prototype.execute=function(t){var e,n;switch(e=value.left.execute(t),n=value.right.execute(t),t.stats.incArithmeticLogicOps(),value.op){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":if(0===n)throw new ExecutionError("divide_by_zero",[]);return parseInt(e/n);case"%":return e%n;case"&":return e&&n;case"|":return e||n;default:throw new ExecutionError("unknown_arithmetic_op",[this.operator])}},e.prototype.toJSON=function(){return{k:"e",l:this.left.toJSON(),r:this.right.toJSON(),o:this.op}},e}(Value),e=function(t){function e(t,e){this.type=t,this.value=e,this.kind="const"}return i(e,t),e.prototype.execute=function(t){return this.value},e.prototype.toJSON=function(){return{k:"c",t:this.type,v:this.value}},e}(Value),n=function(t){function e(t,e){this.vid=t,this.index=e,this.kind="index"}return i(e,t),e.prototype.execute=function(t){var e;if(e=t.memory.get(this.vid),!e.array)throw new ExecutionError("no_array_for_index",[e.name]);return Value.read(this,t)},e.prototype.toJSON=function(){return{k:"i",i:this.vid,x:this.index.toJSON()}},e}(Value),r=function(t){function e(t,e){this.vid=t,this.prop=e,this.kind="prop",this.type="i"}return i(e,t),e.prototype.execute=function(t){var e;if("length"===this.prop)return e=t.memory.get(value.vid),e.array?e.value.split(",").length:1;throw new ExecutionError("unknown_property",[value.prop])},e.prototype.toJSON=function(){return{k:"p",i:this.vid,p:this.prop}},e}(Value),o=function(t){function e(t){this.vid=t,this.kind="var"}return i(e,t),e.prototype.execute=function(t){return Value.read(this,t)},e.prototype.toJSON=function(){return{k:"v",i:this.vid}},e}(Value),window.DataType=function(){function t(){}return t.parse=function(t){var e,n;return n=parseInt(t),n+""===t?{type:"i",value:n}:(e=t.toLowerCase(),"true"===e||"false"===e?{type:"b",value:"true"===e}:!1)},t}()}.call(this),function(){var t=function(t,n){function r(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},e={}.hasOwnProperty;window.Node=function(){function t(){}return t.prototype.execute=function(t,e){throw new Error("Node must override execute() method!")},t.prototype.mark=function(t,e){return e===this.nid?(t.setCursor(this.nid,0),this.nid):-1},t.prototype.toJSON=function(){throw new Error("Node must override toJSON() method!")},t.parse=function(t,e,n){var r;switch(r=t.data("node-type")){case"assign":return AssignNode.parse(t,e,n);case"comment":return CommentNode.parse(t,e,n);case"compare":return CompareNode.parse(t,e,n);case"function":return FunctionNode.parse(t,e,n);case"if":return IfNode.parse(t,e,n);case"inc":return IncNode.parse(t,e,n);case"return":return ReturnNode.parse(t,e,n);case"swap":return SwapNode.parse(t,e,n);case"value":return ValueNode.parse(t,e,n);case"while":return WhileNode.parse(t,e,n);default:throw new Error("Parse error: unknown type: '"+r+"'")}},t.parseAndCheckValue=function(t,e,n){var r;return e=this.findSubNode(e,t),r=Value.parse(e.val(),n),null==r||""===e.val()?e.addClass("error"):e.removeClass("error"),r},t.parseAndCheckVar=function(t,e,n){var r;return e=this.findSubNode(e,t),r=Value.parse(e.val(),n),null==r||"var"!==r.kind&&"index"!==r.kind?(e.addClass("error"),null):(e.removeClass("error"),r)},t.findSubNode=function(t,e){return t.find(e+":first")},t.validate=function(t,e){var n;return n=t.find(".invalid-flag:first"),e?(t.removeClass("invalid"),n.hide()):(t.addClass("invalid"),n.show())},t}(),window.AssignNode=function(e){function n(t,e,n,r){this.nid=t,this.to=e,this.fromNode=n,this.fromVal=r}return t(n,e),n.prototype.execute=function(t,e){var n,r;if(this.fromNode.size()){if(n=this.fromNode.execute(t,0),null!=n.scope)return n;r=n.value}else r=this.fromVal.execute(t);return Value.write(this.to,r,t),{value:r}},n.prototype.mark=function(t,e){return(e===this.nid||e===this.fromNode.nid)&&(e=this.nid),n.__super__.mark.call(this,t,e)},n.prototype.toJSON=function(){var t,e;return{i:this.nid,n:"as",t:null!=(t=this.to)?t.toJSON():void 0,f:this.fromNode.nid,v:null!=(e=this.fromVal)?e.toJSON():void 0}},n.parse=function(t,e,r){var o,i,a,u;return u=n.parseAndCheckVar(".assign-to",t,r),o=BlockNode.parse(n.findSubNode(t,".assign-from"),e,r),e.push(o),i=n.parseAndCheckValue(".assign-from-val",t,r),n.validate(t,null!=u&&(o.size()||null!=i)),a=e.length,new n(a,u,o,i)},n}(Node),window.BlockNode=function(e){function n(t,e){this.nid=t,this.nodes=e,this.curNode=0}return t(n,e),n.prototype.execute=function(t,e){var n,r,o,i,a,u,s;for(n=null,u=this.nodes,r=o=0,i=u.length;i>o;r=++o)if(a=u[r],a>=e){n=t.tree.get(a).execute(t,e);break}return s=null!=(null!=n?n.value:void 0)?n.value:!1,null!=(null!=n?n.scope:void 0)?n:null!=(null!=n?n.next:void 0)?{next:n.next,value:s}:-1===n?{next:-1,value:s}:this.nodes.length>r+1?{next:this.nodes[r+1],value:s}:{value:s}},n.prototype.executeAll=function(t,e,n){var r,o,i,a,u,s,c,l;for(l="all"===n,s=-1,c=this.nodes,o=i=0,a=c.length;a>i;o=++i){if(u=c[o],u>e){s=u;break}if(r=t.tree.get(u).execute(t,u).value,"all"===n&&(l=l&&r),"any"===n&&(l=l||r),window.defaults.shortCircuit&&!l)break}return{value:l,next:s}},n.prototype.evaluateAll=function(t){var e,n,r,o,i,a;for(a=[],i=this.nodes,n=0,r=i.length;r>n;n++)o=i[n],e=t.tree.get(o).execute(t,o).value,a.push(e);return a},n.prototype.mark=function(t,e){var n,r,o,i,a,u,s,c,l;if(e===this.nid){for(c=this.nodes,n=r=0,i=c.length;i>r;n=++r)if(s=c[n],u=t.tree.get(s).mark(t,s),u>-1)return u;return-1}for(l=this.nodes,n=o=0,a=l.length;a>o;n=++o)if(s=l[n],s>=e){if(u=t.tree.get(s).mark(t,e),u>-1)return u;e=s+1}return-1},n.prototype.size=function(){return this.nodes.length},n.prototype.toJSON=function(){return{i:this.nid,n:"bk",c:this.nodes}},n.parse=function(t,e,r){var o,i;return i=[],t.children("li.node").each(function(t,n){var o;return o=Node.parse($(n),e,r),e.push(o),i[t]=o.nid}),o=e.length,new n(o,i)},n}(Node),window.CommentNode=function(e){function n(t,e){this.nid=t,this.comment=e}return t(n,e),n.prototype.execute=function(t,e){return{value:!1}},n.prototype.mark=function(t,e){return-1},n.prototype.toJSON=function(){return{i:this.nid,n:"cm",c:this.comment}},n.parse=function(t,e,r){var o,i;return o=n.findSubNode(t,".comment-text").val(),i=e.length,new n(i,o)},n}(Node),window.CompareNode=function(e){function n(t,e,n,r){this.nid=t,this.left=e,this.right=n,this.operator=r}return t(n,e),n.prototype.execute=function(t,e){var n,r;switch(n=this.left.execute(t),r=this.right.execute(t),t.stats.incCompareOps(),this.operator){case"le":return{value:r>=n};case"lt":return{value:r>n};case"eq":return{value:n===r};case"gt":return{value:n>r};case"ge":return{value:n>=r};case"ne":return{value:n!==r};default:throw new Error("CompareNode: unknown operator: '"+this.operator+"'!")}},n.prototype.toJSON=function(){var t,e;return{i:this.nid,n:"cp",l:null!=(t=this.left)?t.toJSON():void 0,r:null!=(e=this.right)?e.toJSON():void 0,o:this.operator}},n.parse=function(t,e,r){var o,i,a,u;return o=n.parseAndCheckValue(".compare-left",t,r),u=n.parseAndCheckValue(".compare-right",t,r),n.validate(t,null!=o&&null!=u),a=n.findSubNode(t,".compare-operation").val(),i=e.length,new n(i,o,u,a)},n}(Node),window.FunctionNode=function(e){function n(t,e,n,r){this.nid=t,this.callee=e,this.paramsLine=n,this.params=r}return t(n,e),n.prototype.execute=function(t,e){var n,r,o;return r=t.scope,n=$("#scope-"+r+" .node_"+this.nid),null!=n.data("return-value")?(o=n.data("return-value"),n.removeData("return-value"),{value:o}):this.callFunction(t,n)},n.prototype.callFunction=function(t,e){var n,r,o,i;return r=t.scope+1,i=$("#proto-scope-"+this.callee).clone(!0,!0).attr("id","scope-"+r),n=$("<a/>").data("target","#scope-"+r).addClass("scope-"+r),n.attr("aria-controls","scope-"+r).attr("role","tab").attr("data-toggle","tab"),n.text(i.find(".algorithm-name").text()),$("#scopes-head").append($("<li/>").attr("role","presentation").append(n)),$("#scopes-body").append(i),o=this.params.size()?this.params.evaluateAll(t):this.paramsLine,{scope:r,node:this.nid,params:o}},n.prototype.mark=function(t,e){return(e===this.nid||e===this.params.nid)&&(e=this.nid),n.__super__.mark.call(this,t,e)},n.prototype.toJSON=function(){return{i:this.nid,n:"ft",c:this.callee,l:this.paramsLine,p:this.params.nid}},n.parse=function(t,e,r){var o,i,a,u,s,c,l,d,p,h;if(o=t.data("callee-id"),l=[],p=n.findSubNode(t,".act-pars-line").val(),d=!1,""!==p)for(h=p.split(";"),i=0,a=h.length;a>i;i++)s=h[i],s=n.parseValue(s,t,r),null==s?d=!0:l.push(s.value);return c=BlockNode.parse(n.findSubNode(t,".act-pars"),e,r),e.push(c),n.validate(t,o>0&&!d),u=e.length,new n(u,o,l,c)},n}(Node),window.IfNode=function(e){function n(t,e,n,r,o){this.nid=t,this.condition=e,this.ifBody=n,this.elseBody=r,this.op=o}return t(n,e),n.prototype.execute=function(t,e){var n,r,o,i;if(e<=this.condition){if(n=t.tree.get(this.condition),o=n.size(),1===o)r=n.execute(t,e);else{if(!(o>1))throw new ExecutionError("no_condition",[]);r=n.executeAll(t,e,this.op)}return i=r.value+0!==0,r.next>-1?{next:r.next,value:i}:i?{next:this.ifBody,value:i}:{next:this.elseBody,value:i}}return e<=this.ifBody?t.tree.get(this.ifBody).execute(t,e):t.tree.get(this.elseBody).execute(t,e)},n.prototype.mark=function(t,e){return e===this.nid?t.tree.get(this.condition).mark(t,this.condition):e<=this.condition?t.tree.get(this.condition).mark(t,e):e<=this.ifBody?t.tree.get(this.ifBody).mark(t,e):t.tree.get(this.elseBody).mark(t,e)},n.prototype.toJSON=function(){return{i:this.nid,n:"if",c:this.condition,b:this.ifBody,e:this.elseBody,o:this.op}},n.parse=function(t,e,r){var o,i,a,u,s,c;return o=BlockNode.parse(n.findSubNode(t,".if-condition"),e,r),e.push(o),a=BlockNode.parse(n.findSubNode(t,".if-body"),e,r),e.push(a),i=BlockNode.parse(n.findSubNode(t,".if-else"),e,r),e.push(i),c=o.size(),n.validate(t,c>0),s=n.findSubNode(t,".if-operator"),c>1?s.show():s.hide(),u=e.length,new n(u,o.nid,a.nid,i.nid,s.val())},n}(Node),window.IncNode=function(e){function n(t,e,n){this.nid=t,this.variable=e,this.operator=n}return t(n,e),n.prototype.execute=function(t,e){var n,r,o,i;switch(i=this.variable.vid,o=this.variable.execute(t),this.operator){case"i":r=o+1;break;case"d":r=o-1;break;default:throw new Error("IncNode: invalid operator "+this.operator)}return"index"===this.variable.kind?(n=this.variable.index.execute(t),t.memory.arraySet(i,n,r),t.stats.writeArrayVar(i,n,r)):(t.memory.set(i,r),t.stats.writeVar(i,r)),{value:o}},n.prototype.toJSON=function(){var t;return{i:this.nid,n:"ic",v:null!=(t=this.variable)?t.toJSON():void 0,o:this.operator}},n.parse=function(t,e,r){var o,i,a;return a=n.parseAndCheckVar(".inc-var",t,r),n.validate(t,null!=a),i=n.findSubNode(t,".inc-operation").val(),o=e.length,new n(o,a,i)},n}(Node),window.ReturnNode=function(e){function n(t,e,n){this.nid=t,this.retVal=e,this.retNode=n}return t(n,e),n.prototype.execute=function(t,e){var n,r;if(this.retNode.size()){if(n=this.retNode.execute(t,0),null!=n.scope)return n;r=n.value}else r=this.retVal.execute(t);return $("#scope-"+t.scope+" .return-value").val(r).focus(),-1},n.prototype.mark=function(t,e){return(e===this.nid||e===this.retNode.nid)&&(e=this.nid),n.__super__.mark.call(this,t,e)},n.prototype.toJSON=function(){var t;return{i:this.nid,n:"rt",v:null!=(t=this.retVal)?t.toJSON():void 0,r:this.retNode.nid}},n.parse=function(t,e,r){var o,i,a;return a=n.parseAndCheckValue(".return-val",t,r),i=BlockNode.parse(n.findSubNode(t,".return-value-node"),e,r),e.push(i),n.validate(t,null!=a||i.size()),o=e.length,new n(o,a,i)},n}(Node),window.SwapNode=function(e){function n(t,e,n){this.nid=t,this.left=e,this.right=n}return t(n,e),n.prototype.execute=function(t,e){var n,r;return n=this.left.execute(t),r=this.right.execute(t),Value.write(this.left,r,t),Value.write(this.right,n,t),{value:n!==r}},n.prototype.toJSON=function(){var t,e;return{i:this.nid,n:"sw",l:null!=(t=this.left)?t.toJSON():void 0,r:null!=(e=this.right)?e.toJSON():void 0}},n.parse=function(t,e,r){var o,i,a;return o=n.parseAndCheckValue(".swap-left",t,r),a=n.parseAndCheckValue(".swap-right",t,r),n.validate(t,null!=o&&null!=a),i=e.length,new n(i,o,a)},n}(Node),window.ValueNode=function(e){function n(t,e){this.nid=t,this.value=e}return t(n,e),n.prototype.execute=function(t,e){return{value:this.value.execute(t)}},n.prototype.toJSON=function(){var t;return{i:this.nid,n:"vl",v:null!=(t=this.value)?t.toJSON():void 0}},n.parse=function(t,e,r){var o,i;return i=n.parseAndCheckValue(".value-var",t,r),n.validate(t,null!=i),o=e.length,new n(o,i)},n}(Node),window.WhileNode=function(e){function n(t,e,n,r){this.nid=t,this.condition=e,this.body=n,this.op=r}return t(n,e),n.prototype.execute=function(t,e){var n,r,o,i;if(e<=this.condition){if(r=t.tree.get(this.condition),i=r.size(),1===i)o=r.execute(t,e);else{if(!(i>1))throw new ExecutionError("no_condition",[]);o=r.executeAll(t,e,this.op)}return o.next>-1?{next:o.next}:o.value?{next:this.body}:{}}return e<=this.body?(n=t.tree.get(this.body).execute(t,e),null!=n.scope?n:null!=n.next?{next:n.next}:{next:this.condition}):void 0},n.prototype.mark=function(t,e){var n,r;return r=t.tree.get(this.condition),e===this.nid?r.mark(t,this.condition):e<=this.condition?r.mark(t,e):(n=t.tree.get(this.body),n.size()?n.mark(t,e):r.mark(t,this.condition))},n.prototype.toJSON=function(){return{i:this.nid,n:"wl",c:this.condition,b:this.body,o:this.op}},n.parse=function(t,e,r){var o,i,a,u,s;return i=BlockNode.parse(n.findSubNode(t,".while-condition"),e,r),e.push(i),o=BlockNode.parse(n.findSubNode(t,".while-body"),e,r),e.push(o),s=i.size(),n.validate(t,s>0),u=n.findSubNode(t,".while-operator"),s>1?u.show():u.hide(),a=e.length,new n(a,i.nid,o.nid,u.val())},n}(Node)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.Memory=function(){function e(e){this.table=e,this.reset=t(this.reset,this),this.arraySet=t(this.arraySet,this),this.arrayGet=t(this.arrayGet,this),this.arrayCheck=t(this.arrayCheck,this),this.set=t(this.set,this),this.get=t(this.get,this),this.find=t(this.find,this),this.count=t(this.count,this),this.memory=new Object,this.original=new Object,this.table.children().not("#var-prototype").each(function(t){return function(e,n){var r,o,i,a;return a=$(n).data("vid"),o=$(n).data("name"),i=$(n).data("value"),r="["===$(n).data("type").charAt(0),t.memory[a]={vid:a,name:o,value:i,array:r,count:0},t.original[a]={vid:a,name:o,value:i,array:r,count:0}}}(this))}return e.prototype.count=function(t){var e;return e=this.memory[t],++e.count},e.prototype.find=function(t){var e;return e=-1,$.each(this.memory,function(n,r){return r.name===t?e=r.vid:void 0}),e},e.prototype.get=function(t){return this.memory[t]},e.prototype.set=function(t,e){var n;try{e.split(","),this.memory[t].array=!0}catch(e){n=e,this.memory[t].array=!1}return this.memory[t].value=e},e.prototype.arrayCheck=function(t,e){var n,r;if(r=this.get(t),!r.array)throw new ExecutionError("no_array_for_index",[r.name]);if(n=r.value.split(","),0>e||n.length<=e)throw new ExecutionError("index_out_of_bounds",[r.name,e,n.length]);return n},e.prototype.arrayGet=function(t,e){var n,r;return n=this.arrayCheck(t,e),r=n[e],parseInt(r)+""===r?parseInt(r):r},e.prototype.arraySet=function(t,e,n){var r;return r=this.arrayCheck(t,e),r[e]=n,this.set(t,r.join(","))},e.prototype.reset=function(){return $.each(this.original,function(t){return function(e,n){return t.memory[e].value=n.value,t.memory[e].count=0}}(this))},e}()}.call(this),function(){var t=function(t,n){function r(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},e={}.hasOwnProperty;window.Tree=function(){function t(t){this.scope=t,this.memory=new Memory($("#scope-"+this.scope+" .variables>tbody")),this.reset()}return t.prototype.execute=function(t,e){return this.get(this.root).execute(t,e)},t.prototype.mark=function(t,e){return this.get(this.root).mark(t,e)},t.prototype.get=function(t){return this.nodes[t]},t.prototype.reset=function(){var t;return this.memory.reset(),this.nodes=[],t=BlockNode.parse($("#scope-"+this.scope+" .node_root"),this.nodes,this.memory),this.root=this.nodes.length,this.nodes.push(t)},t.prototype.toJSON=function(){var t,e,n,r,o,i;for(n=[],i=this.nodes,t=e=0,r=i.length;r>e;t=++e)o=i[t],n[t]=o.toJSON();return n},t.toJSON=function(){return new this(0).toJSON()},t}(),window.ExecutionError=function(e){function n(t,e){this.message=t,this.parts=e}return t(n,e),n}(Error)}.call(this),function(){var t,e,n,r,o,i,a,u;e=$(".node_root"),r=$("#insertVarsHere"),t=function(){function t(){}return t.editInfo=function(){var t,e,n;return n=$("#in-name").val(),t=$("#in-desc").val(),e=$("#in-long").val(),$.ajax("api/algorithm.php?area=info",{type:"POST",data:{name:n,desc:t,long:e,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return null==e.error?(t._printSuccess(e.success),$(".has-error").removeClass("has-error")):(t._printError(e.error),null!=e.name?$("#in-name").val(e.name).closest(".form-group").addClass("has-error"):void 0)}}(this),error:function(t){return function(e,n,r){return t._printError("Request Error: "+r)}}(this)})},t.editTags=function(){var t;return t=$("#in-tags").val(),$.ajax("api/tag.php",{type:"POST",data:{tags:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return $("#in-tags").val(e.tags),null==e.error?(t._printSuccess(e.success),$(".has-error").removeClass("has-error")):(t._printError(e.error),null!=e.tags?$("#in-tags").closest(".form-group").addClass("has-error"):void 0)}}(this),error:function(t){return function(e,n,r){return t._printError("Request Error: "+r)}}(this)})},t.editVariable=function(t){var e,n,r,o,i;return i=$("#var-"+t),e=i.find(".name").val(),r=i.find(".type").val(),o=i.find(".value").val(),n=i.find(".size").val(),$.ajax("api/algorithm.php?area=var&action=edit",{type:"POST",data:{vid:t,name:e,type:r,value:o,size:n,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(e){return function(n){var r,o,a,u,s,c;for(a=null!=(u=n.error)?u:"",i=$("#var-"+t),s=["name","type","value","size"],r=0,o=s.length;o>r;r++)c=s[r],null!=n["error-"+c]?(a+=n["error-"+c],i.find("."+c+"-group").addClass("has-error")):(i.find("."+c+"-group").removeClass("has-error"),i.data(c,n[c]));return""!==a?e._printError(a):(e._printSuccess(n.success),i.find(".edit").hide(),i.find(".view .cell").text(n.viewLabel),null!=n.viewMode?i.find(".view .details").text("("+n.viewMode+")").show():i.find(".view .details").hide(),i.find(".view").show(),initVarInput($(".insertStepsHere").find(".combobox")))}}(this),error:function(t){return function(e,n,r){return t._printError("Request Error: "+r)}}(this)})},t.removeVariable=function(t){return $.ajax("api/algorithm.php?area=var&action=remove",{type:"POST",data:{vid:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(e){return function(n){return null!=n.error?e._printError(n.error):(e._printSuccess(n.success),$("#var-"+t).hide("slow",function(){return $(this).remove()}))}}(this),error:function(t){return function(e,n,r){return t._printError("Request Error: "+r)}}(this)})},t.editScript=function(t){return $.ajax("api/algorithm.php?area=script",{type:"POST",data:{tree:t,aid:window.current.aid,lang:window.current.lang},dataType:"json",success:function(t){return function(e){return null!=e.error?t._printError(e.error):t._printSuccess(e.success)}}(this),error:function(t){return function(e,n,r){return t._printError("Storage Error: "+r)}}(this)})},t.parseMarkdown=function(t,e){return $.ajax("api/markdown.php",{type:"POST",data:{source:$(t).val()},dataType:"json",success:function(t){return function(t){return""===t.html?$(e).parent().hide("slow"):$(e).html(t.html).parent().show("slow")}}(this),error:function(t){return function(e,n,r){return t._printError("Request Error: "+r)}}(this)})},t._printError=function(t){return $("#alertText").html(t),$("#alert").show("slow")},t._printSuccess=function(t){return $("#alert").hide("slow"),$("#saveSuccess:hidden").text(t).show("slow",function(){return $(this).fadeOut(3e3)})},t}(),o=function(){function e(){var t;t=$(".varRow").not("#var-prototype").last().data("vid"),this.maxVarId=null!=t?t+1:0,this.updateVarCount()}return e.prototype.addRow=function(){var t;return t=$("#var-prototype").clone(!0).attr("id","var-"+this.maxVarId).data("vid",this.maxVarId).appendTo(r),t.find(".btn-var-count").data("target","var-"+this.maxVarId),t.find(".edit").show(),t.find(".view").hide(),t.show("slow"),initValueInput(t),this.maxVarId++},e.prototype.updateVarCount=function(){return $(".varRow").not("#var-prototype").each(function(){var t,e,n;return n=$(this).data("vid"),e=new Tree(0),t=e.memory.get(n).count,$(this).find(".counter").text(t),0!==t?$(this).find(".btn-var-remove").attr("disabled","disabled"):$(this).find(".btn-var-remove").removeAttr("disabled")})},e.prototype.performCancel=function(t){var e,n;return $("#alert").hide("slow"),n=$("#var-"+t),e=n.data("name"),null!=e&&""!==e?(n.find(".name").val(e),n.find(".init").val(n.data("init")),n.find(".value").val(n.data("value")),n.find(".size").val(n.data("size")),n.find(".edit").hide(),n.find(".view").show()):n.hide("slow",function(){return $(this).remove()})},e.prototype.performCheck=function(e){return t.editVariable(e)},e.prototype.performEdit=function(t){var e;return e=$("#var-"+t),initValueInput(e),e.find(".edit").show().find(".name").attr("disabled","disabled"),e.find(".view").hide()},e.prototype.performRemove=function(e){return t.removeVariable(e)},e}(),n=function(){function n(t){this.varForm=t}return n.prototype.addNode=function(t){var n;return n=$(".prototypes ."+t).clone().appendTo(e),this.varForm.updateVarCount(),this.updateSortable(),this.updateActionHandlers(n),n},n.prototype.removeNode=function(t){return t.hide("slow",function(e){return function(){return t.remove(),e.varForm.updateVarCount(),e.updateExpandables(),e.saveChanges()}}(this))},n.prototype.saveChanges=function(){var n;return n=Tree.toJSON(),e.find(".invalid").length?!1:(this.varForm.updateVarCount(),t.editScript(n),!0)},n.prototype.updateActionHandlers=function(t){return initVarInput(t.find(".combobox")),initFuncInput(t.find(".combobox-functions")),t.find("input, textarea").off("blur").blur(function(t){return function(){return t.saveChanges()}}(this)),t.find("select").off("change").change(function(t){return function(){return t.saveChanges()}}(this)),t.find(".node-remove").off("click").click(function(t){return function(e){return t.removeNode($(e.currentTarget).parents(".node:first"))}}(this))},n.prototype.updateExpandables=function(){return e.find(".expandable").each(function(){return 0===$(this).find(".expand-body .node").length?($(this).removeClass("expanded"),$(this).find(".bottom-collapsed-only").addClass("bottom")):void 0})},n.prototype.updateSortable=function(){var t,n,r,o;return t=function(t){return function(){return t.saveChanges(),!0}}(this),r=function(t){return $(t).addClass("expanded"),$(t).find(".bottom-collapsed-only").removeClass("bottom")},o={connectWith:".sortable",placeholder:"sortable-highlight",forcePlaceholderSize:!0,greedy:!0,tolerance:"pointer",update:t,stop:this.updateExpandables},n={accept:".node",tolerance:"pointer",over:function(){return r(this)}},e.find(".sortable").each(function(){return null!=$(this).sortable("instance")?$(this).sortable("destroy"):void 0}),e.find(".expandable").each(function(){return null!=$(this).droppable("instance")?$(this).droppable("destroy"):void 0}),e.sortable(o),e.find(".sortable").sortable(o),e.find(".expandable").droppable(n)},n}(),u=function(t){var e,n;return e=$(t).find("option:selected"),n=e.closest(".varRow").find(".size-group"),".size"===e.data("target")?n.show("slow").find(".size").focus():n.hide("slow")},a=function(){var t;return t=0,function(e,n){return clearTimeout(t),t=setTimeout(e,n)}}(),i=function(){return t.parseMarkdown($("#in-long"),$("#description-preview"))},$(function(){var r,s;return initTagInput($("#in-tags")),$("#in-name, #in-desc, #in-long").blur(function(){return t.editInfo()}),$("#in-tags").blur(function(){return t.editTags()}),$("#in-long").keyup(function(){return a(function(){return i()},500)}),$("#refresh-preview").click(function(){return i()}),s=new o,$("#btnAddVar").click(function(){return s.addRow()}),$(".btn-var-cancel").click(function(){return s.performCancel($(this).parents(".varRow").data("vid"))}),$(".btn-var-check").click(function(){return s.performCheck($(this).parents(".varRow").data("vid"))}),$(".btn-var-edit").click(function(){return s.performEdit($(this).parents(".varRow").data("vid"))}),$(".btn-var-remove").click(function(){return s.performRemove($(this).parents(".varRow").data("vid"))}),$(".type").change(function(){return u($(this))}),r=new n(s),r.updateActionHandlers(e),r.updateSortable(),$("#node-btn-group a").click(function(){
return r.addNode($(this).data("node"))}),$(".toggle-comment").click(function(){return $(this).parent().find(".comment-container").toggle("slow"),$(this).toggleClass("fa-plus-square fa-minus-square")}),Tree.toJSON(0)})}.call(this);